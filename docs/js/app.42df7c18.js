(function(){var e={1865:function(e,t,i){"use strict";var o=i(9242),r=i(3396);function n(e,t,i,o,n,s){const a=(0,r.up)("TronBox");return(0,r.wg)(),(0,r.j4)(a,{"canvas-id":"grid"})}var s=i(7139);const a=e=>((0,r.dD)("data-v-3d223837"),e=e(),(0,r.Cn)(),e),d={class:"grid-box"},l=a((()=>(0,r._)("div",{class:"header"},[(0,r._)("h1",null,"Battle Tron")],-1))),c={class:"flex-box-row"},h=["id"],u={class:"editor"},v={class:"controls"},f={class:"control"},p={class:"control"};function g(e,t,i,n,a,g){return(0,r.wg)(),(0,r.iD)("div",d,[l,(0,r._)("div",c,[(0,r._)("div",null,[(0,r._)("canvas",{id:i.canvasId,class:"canvas-style",width:"500",height:"500"},null,8,h)]),(0,r._)("div",u,[(0,r._)("div",v,[(0,r._)("div",f,[(0,r._)("button",{class:"btn btn-dark",onClick:t[0]||(t[0]=t=>g.addTrail(e.botA))},"ADD [A]"),(0,r.wy)((0,r._)("input",{id:"colorPickerA","onUpdate:modelValue":t[1]||(t[1]=t=>e.botA.color=t),type:"color"},null,512),[[o.nr,e.botA.color]])]),(0,r._)("div",p,[(0,r._)("button",{class:"btn btn-dark",onClick:t[2]||(t[2]=t=>g.addTrail(e.botB))},"ADD [B]"),(0,r.wy)((0,r._)("input",{id:"colorPickerB","onUpdate:modelValue":t[3]||(t[3]=t=>e.botB.color=t),type:"color"},null,512),[[o.nr,e.botB.color]])]),(0,r._)("button",{class:"btn btn-dark",onClick:t[4]||(t[4]=e=>g.clear())},"CLEAR"),(0,r._)("button",{class:"btn btn-dark",onClick:t[5]||(t[5]=e=>g.reset())},"RESET"),(0,r._)("button",{class:"btn btn-dark",onClick:t[6]||(t[6]=e=>g.togglePause())},(0,s.zw)(g.pauseBtnText),1),(0,r._)("button",{class:"btn btn-dark",onClick:t[7]||(t[7]=e=>g.step())},"STEP")]),(0,r.wy)((0,r._)("textarea",{"onUpdate:modelValue":t[8]||(t[8]=t=>e.botA.js=t),class:"code-area"},null,512),[[o.nr,e.botA.js]]),(0,r.wy)((0,r._)("textarea",{"onUpdate:modelValue":t[9]||(t[9]=t=>e.botB.js=t),class:"code-area"},null,512),[[o.nr,e.botB.js]])])])])}i(2262),i(4506);const b=i(5445);class w{constructor(e){this.canvasId=e,this.reset()}reset(){b.project?.activeLayer?.removeChildren(),b.projects.forEach((e=>{console.log("Unexpected project found. Removing..."),e.remove()})),b.setup(this.canvasId),this.grid=void 0,this.trailStuff={},this.colors=["#A72334","#FC7A43","#ECCF39","#6FAF60","#02654B","#188DBF","#22379B","#7209b7","#f72585"],this.colorIndex=0}render(e,t){if(void 0===this.grid){var i=50;this.grid=e.map(((e,t)=>e.map(((e,o)=>{var r=new b.Path.Rectangle(new b.Point(t*i,o*i),new b.Size(i,i));r.strokeColor="#444";let n="#090909";return r.fillColor=n,r}))))}for(let o of t){this.trailStuff[o.id]||(this.trailStuff[o.id]={});let e=this.trailStuff[o.id];for(let r of o.tail){let e=this.grid[r.x][r.y];e.fillColor=o.color,e.strokeWidth=1,e.shadowColor="#000",e.shadowBlur=10}e.wireframe||(e.wireframe=new b.Path([...o.tail,o.head].map((e=>this.grid[e.x][e.y].position))),e.wireframe.strokeColor=new b.Color(0,0,0,.25),e.wireframe.strokeWidth=5),e.wireframe.segments.at(-1).x!=o.head.x&&e.wireframe.segments.at(-1).y!=o.head.y&&e.wireframe.add(this.grid[o.head.x][o.head.y].position);let t=this.grid[o.head.x][o.head.y];t.strokeColor=o.color,t.fillColor=o.color,t.strokeWidth=10,t.shadowColor="#000",t.shadowBlur=20,t.bringToFront();let i=e.headIndicator;if(i||(i=new b.Path.Circle(t.position,15),i.fillColor=o.color,i.strokeColor="#FFF",i.strokeWidth=10,e.headIndicator=i),!o.alive&&!e.deadSymbolHead){i.remove();let o=new b.Path.RegularPolygon(t.position,3,25);o.fillColor="#000",o.position=t.position,e.deadSymbolHead=o}e.wireframe.bringToFront(),i.bringToFront(),i.position=t.position,e.deadSymbolHead?.bringToFront()}}}class y{constructor(e=0,t=0){this.x=e,this.y=t}}const m={colors:["#A72334","#FC7A43","#ECCF39","#6FAF60","#02654B","#188DBF","#22379B","#7209b7","#f72585"],MoveDirection:{UP:new y(0,-1),DOWN:new y(0,1),LEFT:new y(-1,0),RIGHT:new y(1,0)}};var x=i(9782);class P{constructor(){}static isOccupied(e,t){if(e&&e.length&&e[0].length&&!(t.x>=e.length||t.x<0||t.y<0||t.y>=e[t.x].length))return!!e[t.x][t.y].occupied}static flatten(e){return e.map(((e,t)=>e.map(((e,i)=>({occupied:e.occupied,position:new Point(t,i)}))))).flatMap((e=>e))}}class T{constructor(){window.Constants=m,window.Point=x.Point,window.Grid=P,this.reset()}reset(){this.path=null,this.point={x:0,y:0},this.grid=void 0,this.trails=[],this.gridWidth=10,this.colorIndex=0,this.createGrid()}createGrid(){this.grid=[];for(var e=0;e<this.gridWidth;e++){this.grid[e]=[];for(var t=0;t<this.gridWidth;t++){var i={id:void 0,get occupied(){return void 0!=this.id}};this.grid[e].push(i)}}}createTrail(e,t,i,o,r){let n={head:new x.Point(e,t),tail:[],color:i,alive:!0,id:o,getMove:r,applyMove(e,t,i,o){if(!o||void 0==o.x||void 0==o.y)return console.log("Error - moveDir is not a valid Point object. Killing trail. moveDir supplied:",o),void(this.alive=!1);if(!Object.keys(m.MoveDirection).map((e=>m.MoveDirection[e])).some((e=>o.x==e.x&&o.y==e.y)))return console.log("Invalid move supplied! Killing trail. Move supplied: ",o),void(this.alive=!1);let r=new x.Point(i.x+o.x,i.y+o.y);if(r.x<0||r.x>=e.length||r.y<0||r.y>=e[0].length)return console.log(`%cTRAIL [${this.id}] %ctried to escape the grid! They failed...`,"color: "+this.color,"color: auto"),void(this.alive=!1);if(e[r.x][r.y].occupied){var s=e[r.x][r.y].id,a=t.find((e=>e.id==s));return console.log(`%cTRAIL [${this.id}] %chit %cTRAIL [${a.id}]`,"color: "+this.color,"color: auto","color: "+a.color),void(this.alive=!1)}this.tail.push(this.head),this.head=r,e[n.head.x][n.head.y].id=n.id}};return n}parseRawJsIntoGetMoveFunction(e){let t=new Function("return getMove; "+e)();return t}getRandomValidPos(){var e=P.flatten(this.grid).filter((e=>!e.occupied));if(!(e.length<1)){var t=e[Math.floor(Math.random()*e.length)].position;return t}console.log("No open spots to spawn in a tron bike!")}getRandomColor(){var e=m.colors[this.colorIndex++];if(!(this.colorIndex>=m.colors.length))return e;console.log("No more colors to create a trail with...")}addTrail(e,t,i){if(i=i||this.getRandomValidPos(),i){t=t||this.getRandomColor();var o=this.trails.length,r=this.createTrail(i.x,i.y,t,o,e);this.trails.push(r),this.grid[r.head.x][r.head.y].id=r.id}}iterateTrails(){for(let i of this.trails.filter((e=>e.alive))){try{var e=i.getMove(this.grid,i.head)}catch(t){console.log("Error executing script: ",t,i.getMove)}i.applyMove(this.grid,this.trails,i.head,e)}}step(){this.iterateTrails()}}var C="// Clockwise bot - Example:\nfunction getMove(grid, headPos) {\n  var dir = Constants.MoveDirection;\n  if (validMove(grid, headPos, dir.RIGHT)) return dir.RIGHT;\n  if (validMove(grid, headPos, dir.DOWN)) return dir.DOWN;\n  if (validMove(grid, headPos, dir.LEFT)) return dir.LEFT;\n  if (validMove(grid, headPos, dir.UP)) return dir.UP;\n  return dir.RIGHT;\n}\n\nfunction validMove(grid, headPos, move) {\n  var nextPos = new Point(headPos.x + move.x, headPos.y + move.y);\n  var isOccupied = Grid.isOccupied(grid, nextPos);\n  return isOccupied == false; // this works because isOccupied is \n  //    exactly false if the square is free, \n  //    true if occupied, \n  //    undefined if out of bounds\n}",k="// Counter-Clockwise bot - Example:\nfunction getMove(grid, headPos) {\n  var dir = Constants.MoveDirection;\n  if (validMove(grid, headPos, dir.LEFT)) return dir.LEFT;\n  if (validMove(grid, headPos, dir.DOWN)) return dir.DOWN;\n  if (validMove(grid, headPos, dir.RIGHT)) return dir.RIGHT;\n  if (validMove(grid, headPos, dir.UP)) return dir.UP;\n  return dir.RIGHT;\n}\n\nfunction validMove(grid, headPos, move) {\n  var nextPos = new Point(headPos.x + move.x, headPos.y + move.y);\n  var isOccupied = Grid.isOccupied(grid, nextPos);\n  return isOccupied == false; // this works because isOccupied is \n  //    exactly false if the square is free, \n  //    true if occupied, \n  //    undefined if out of bounds\n}",M={name:"TronBox",props:{canvasId:{type:String,required:!0}},data:()=>({botA:{js:void 0,color:"#FF0000"},botB:{js:void 0,color:"#0000FF"},renderer:void 0,engine:void 0,paused:!0}),computed:{pauseBtnText:function(){return this.paused?"PLAY":"PAUSE"}},mounted(){this.renderer=new w(this.canvasId),this.engine=new T,this.botA.js=C,this.botB.js=k,this.start()},methods:{addTrail(e){let t=this.engine.parseRawJsIntoGetMoveFunction(e.js);this.engine.addTrail(t,e.color)},clear(){this.engine.reset(),this.renderer.reset()},step(){this.engine.step()},reset(){this.clear(),this.addInitialTrails()},addInitialTrails(){this.addTrail(this.botA),this.addTrail(this.botB)},start(){this.addInitialTrails(),this.loop()},togglePause(){this.paused=!this.paused},loop(){this.paused||this.engine.step(),this.renderer.render(this.engine.grid,this.engine.trails),setTimeout(this.loop,50)}}},F=i(89);const I=(0,F.Z)(M,[["render",g],["__scopeId","data-v-3d223837"]]);var O=I,A={name:"App",components:{TronBox:O}};const _=(0,F.Z)(A,[["render",n]]);var B=_;i(8937);(0,o.ri)(B).mount("#app")},858:function(){},4158:function(){}},t={};function i(o){var r=t[o];if(void 0!==r)return r.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,i),n.exports}i.m=e,function(){var e=[];i.O=function(t,o,r,n){if(!o){var s=1/0;for(c=0;c<e.length;c++){o=e[c][0],r=e[c][1],n=e[c][2];for(var a=!0,d=0;d<o.length;d++)(!1&n||s>=n)&&Object.keys(i.O).every((function(e){return i.O[e](o[d])}))?o.splice(d--,1):(a=!1,n<s&&(s=n));if(a){e.splice(c--,1);var l=r();void 0!==l&&(t=l)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[o,r,n]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,n,s=o[0],a=o[1],d=o[2],l=0;if(s.some((function(t){return 0!==e[t]}))){for(r in a)i.o(a,r)&&(i.m[r]=a[r]);if(d)var c=d(i)}for(t&&t(o);l<s.length;l++)n=s[l],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(c)},o=self["webpackChunktronbox"]=self["webpackChunktronbox"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=i.O(void 0,[998],(function(){return i(1865)}));o=i.O(o)})();
//# sourceMappingURL=app.42df7c18.js.map